# 分阶段游戏开发系统说明

## 概述

重新设计了游戏开发流程，从原来的"直接开发"改为更真实的**三阶段开发模式**，让游戏开发过程更加真实和策略化。

## 三个开发阶段

### 阶段1：需求文档（📋 DESIGN）

**职责**：策划师编写游戏需求文档和设计方案

**所需职位**：
- 策划师（必需）

**人数要求**：
- 最少：1人
- 推荐：2人

**技能倍率**：
- 1级 = 0.5x
- 2级 = 0.8x
- 3级 = 1.0x
- 4级 = 1.3x
- 5级 = 1.6x

**人数倍率**（线性增长，每人+0.3x）：
- 1人 = 1.0x
- 2人 = 1.3x
- 3人 = 1.6x
- 4人 = 1.9x
- 5人 = 2.2x
- 6人 = 2.5x
- 7人 = 2.8x
- 8人 = 3.1x
- 9人 = 3.4x
- 10人+ = 4.0x（封顶）

---

### 阶段2：美术音效（🎨 ART_SOUND）

**职责**：美术师和音效师制作游戏资源

**所需职位**：
- 美术师
- 音效师
（两种职位均可，至少有一种）

**人数要求**：
- 最少：1人
- 推荐：2人

**技能计算**：取美工技能和音乐技能中的**较高值**

---

### 阶段3：程序实现（💻 PROGRAMMING）

**职责**：程序员实现游戏功能和逻辑

**所需职位**：
- 程序员（必需）

**人数要求**：
- 最少：1人
- 推荐：2人

---

## 进度计算规则

### 基础进度
每天基础进度：**2%**

### 最终进度公式
```
每日进度 = 基础进度(2%) × 技能倍率 × 人数倍率
```

### 进度示例

#### 示例1：单人低技能
- 1个2级策划师
- 每日进度 = 2% × 0.8 × 1.0 = **1.6%**
- 完成时间：约**63天**

#### 示例2：双人中等技能
- 2个3级策划师
- 每日进度 = 2% × 1.0 × 1.3 = **2.6%**
- 完成时间：约**38天**

#### 示例3：双人高技能
- 2个5级程序员
- 每日进度 = 2% × 1.6 × 1.3 = **4.16%**
- 完成时间：约**24天**

#### 示例4：三人高技能
- 3个5级对应职位员工
- 每日进度 = 2% × 1.6 × 1.6 = **5.12%**
- 完成时间：约**20天**

#### 示例5：五人团队
- 5个3级对应职位员工
- 每日进度 = 2% × 1.0 × 2.2 = **4.4%**
- 完成时间：约**23天**

#### 示例6：九人大团队
- 9个2级对应职位员工
- 每日进度 = 2% × 0.8 × 3.4 = **5.44%**
- 完成时间：约**18天**

#### 示例7：精英团队
- 9个5级对应职位员工
- 每日进度 = 2% × 1.6 × 3.4 = **10.88%**
- 完成时间：约**9天**

---

## 总开发时间

**理想情况**（每阶段3个5级员工）：
- 需求文档：约20天
- 美术音效：约20天
- 程序实现：约20天
- **总计：约60天（2个月）**

**精英团队**（每阶段9个5级员工）：
- 需求文档：约9天
- 美术音效：约9天
- 程序实现：约9天
- **总计：约27天（1个月）**

**最低配置**（每阶段1个2级员工）：
- 需求文档：约63天
- 美术音效：约63天
- 程序实现：约63天
- **总计：约189天（6个月）**

---

## 核心机制

### 1. 阶段切换
- 当前阶段进度达到100%时，自动进入下一阶段
- 进入新阶段时，**自动清空已分配员工**
- 玩家需要重新为新阶段分配合适的员工

### 2. 职位匹配
- 只有**符合当前阶段要求的职位**才能贡献进度
- 不符合要求的员工分配后不会产生任何效果
- 例如：需求文档阶段分配程序员，进度不会增长

### 3. 最低人数要求
- 每个阶段至少需要**1名**对应职位的员工
- 未满足最低人数时，进度不会增长
- 分配了不符合职位的员工也不计入人数

### 4. 总进度显示
整个游戏开发的总进度由三个阶段平均组成：
- 需求文档：0% - 33%
- 美术音效：33% - 66%
- 程序实现：66% - 100%

---

## UI显示

### 开发中游戏卡片显示：

1. **阶段标签**：显示当前所在阶段（📋需求文档 / 🎨美术音效 / 💻程序实现）

2. **阶段要求卡片**：
   - 当前阶段名称和描述
   - 所需职位（绿色标签）
   - 人数要求（最少X人 · 推荐Y人）

3. **进度条**：
   - 显示当前阶段的进度百分比
   - 整体游戏开发进度

4. **已分配员工列表**：
   - 显示当前分配的员工
   - 只有符合职位要求的员工才会贡献进度

---

## 游戏策略

### 前期（1-2年）
- 专注培养少数精英员工
- 每阶段只配1-2人，降低成本
- 接受较长的开发周期（3-6个月）

### 中期（3-5年）
- 建立多职位团队
- 每个职位至少2人
- 开发周期缩短到2-3个月

### 后期（5年+）
- 大型开发团队
- 每阶段3-4人，全员4-5级技能
- 开发周期缩短到1-2个月
- 可以同时开发多个项目

---

## 与旧系统对比

### 旧系统问题
❌ 必须同时满足程序5人、策划5人、音效5人、美术5人才能开发
❌ 直接开发，缺乏真实感
❌ 一次性分配员工，缺少策略深度

### 新系统优势
✅ 每阶段最少只需1人，大幅降低门槛
✅ 三阶段流程符合真实开发流程
✅ 需要根据阶段动态调整人员配置
✅ 不同职位在不同阶段发挥作用
✅ 更强的策略性和资源管理
✅ **人数倍率线性增长**：多雇员工有明显收益，每增加1人+30%效率

---

## 技术实现

### 修改的文件

1. **GameData.kt**
   - 新增 `DevelopmentPhase` 枚举
   - 定义三个开发阶段的详细配置
   - 添加阶段验证和进度计算逻辑
   - 在 `Game` 数据类中添加 `currentPhase` 和 `phaseProgress` 字段

2. **MainActivity.kt**
   - 重写开发进度计算逻辑
   - 实现阶段切换机制
   - 阶段完成时清空员工分配

3. **EnhancedGameProjectCard.kt**
   - 添加开发阶段标签显示
   - 添加阶段要求说明卡片
   - 显示所需职位和人数要求

### 核心函数

```kotlin
// 检查是否满足当前阶段要求
fun DevelopmentPhase.checkRequirements(employees: List<Employee>): Boolean

// 获取当前阶段的有效员工
fun DevelopmentPhase.getValidEmployees(employees: List<Employee>): List<Employee>

// 计算阶段进度增长速度
fun DevelopmentPhase.calculateProgressSpeed(employees: List<Employee>): Float

// 获取下一个开发阶段
fun DevelopmentPhase.getNextPhase(): DevelopmentPhase?
```

---

## 向后兼容

- 旧存档中的游戏自动设置为 `currentPhase = DESIGN`，`phaseProgress = 0f`
- 根据原有的 `developmentProgress` 估算应该处于哪个阶段
- 完全兼容旧存档，可正常游玩

---

## 数值平衡

### 设计目标
1. **降低开发门槛**：新手期只需1-2人即可开发
2. **保持合理开发周期**：避免过快或过慢
3. **鼓励团队建设**：多人配置明显加速开发
4. **高技能回报**：高级员工能大幅提升效率

### 完成时间对比
| 配置 | 每阶段时间 | 总时间 | 备注 |
|------|------------|--------|------|
| 1人2级 | 63天 | 189天（6月）| 最低配置 |
| 2人3级 | 38天 | 114天（4月）| 早期推荐 |
| 2人5级 | 24天 | 72天（2.4月）| 精英小队 |
| 3人5级 | 20天 | 60天（2月）| 标准配置 |
| 5人3级 | 23天 | 69天（2.3月）| 中型团队 |
| 9人2级 | 18天 | 54天（1.8月）| 大团队低技能 |
| 9人5级 | 9天 | 27天（1月）| 精英大团队 |

---

## 游戏体验提升

1. **更真实的开发流程**：模拟真实游戏公司的开发阶段
2. **策略深度增加**：需要考虑不同阶段的人员配置
3. **降低门槛**：新手玩家更容易上手
4. **保持挑战性**：追求高效率仍需精心规划

---

## 后续优化方向

1. **阶段完成提示**：弹窗提示玩家当前阶段已完成，需要分配新员工
2. **自动推荐员工**：根据当前阶段自动推荐合适的员工
3. **阶段进度通知**：每个阶段完成时给予奖励或成就
4. **阶段跳过机制**：特殊情况下允许加速某个阶段

---

## 更新日期
2025-01-24
