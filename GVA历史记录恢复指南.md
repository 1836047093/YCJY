# GVA历史记录恢复指南

## 问题描述

如果您遇到以下情况：
- ✅ 第1年12月15日看到了GVA提名
- ✅ 现在已经到了第2年
- ❌ 但"历史记录"标签页显示"暂无历史记录"

**这是由于旧版本的bug导致的数据丢失。**

## 解决方案（自动恢复）⭐

### 方法1：重新加载存档（推荐）

1. 保存当前游戏（如果还没保存）
2. 返回主菜单
3. **重新加载存档**
4. 进入GVA界面，点击"历史记录"标签页
5. 历史记录应该**自动恢复**并显示第1年的获奖记录

### 方法2：推进到下个月

如果方法1没有生效：
1. 继续游玩，推进到下个月1号
2. 系统会自动检测并恢复历史记录
3. 进入GVA界面查看

## 工作原理

游戏现在会自动检测以下情况：
- 当年提名不为空（说明您确实经历过评选）
- 历史记录为空（说明数据丢失）
- 提名已经是最终结果（说明12月31日已颁奖）

当检测到这些条件时，系统会**自动将当年提名复制到历史记录**，无需您手动操作。

## 恢复后的显示

恢复成功后，您将看到：
- 📜 **历史记录**：显示第1年所有获奖的奖项
- 🏆 **获奖游戏**：您获奖的游戏会高亮显示
- ⭐ **声望统计**：显示正确的获奖和提名数量

## 注意事项

### 哪些奖项会显示？

历史记录只显示**有获奖者的奖项**。如果某个奖项没有符合条件的游戏（例如评分太低、类型不匹配），就不会在历史记录中显示。

这是**正常行为**，不是bug。

### 如果还是看不到？

可能的原因：
1. 第1年没有发售评分≥6.0的游戏
2. 所有游戏都在12月14日之后发售（评选时间是1月1日-12月14日）
3. 游戏评分太低或不符合奖项要求

## 未来保障

从现在开始：
- ✅ 所有新的评选和颁奖数据都会**正确保存**
- ✅ 存档保存后重新加载，数据**不会丢失**
- ✅ 每年的历史记录都会**正常累积**

## 技术细节（开发者）

### 补偿机制触发时机

1. **游戏加载时**：`LaunchedEffect(Unit)` 第1426-1440行
2. **每月1号**：日结算逻辑 第1502-1515行

### 补偿条件

```kotlin
if (currentYearNominations.isNotEmpty() && 
    gvaHistory.isEmpty() && 
    currentYearNominations.any { it.isFinal }) {
    
    gvaHistory = currentYearNominations
}
```

### 日志输出

在Logcat中搜索以下关键字：
- `🔧 [启动时检测] GVA历史记录丢失`
- `✅ GVA历史记录补偿完成`

---

**修复完成时间**：2025年1月23日

**修复类型**：🔴 严重Bug修复 + ✅ 自动数据恢复
