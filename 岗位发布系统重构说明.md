# 岗位发布系统重构说明

## 概述

已成功将人才市场从"浏览候选人"模式重构为"岗位发布"模式。新系统允许玩家主动发布招聘岗位，候选人会随时间推进来应聘，玩家可以选择自己面试或让人事部门面试。

## 核心功能

### 1. 岗位发布

玩家可以创建招聘岗位，设置以下条件：
- **岗位类型**：程序员、策划师、美术师、音效师、客服
- **最低技能等级**：1-5级
- **薪资范围**：¥3,000 - ¥50,000

### 2. 应聘者生成机制

- **自动生成**：随着时间推进，系统会为活跃岗位生成应聘者
- **智能匹配**：应聘者符合岗位的技能和薪资要求
- **吸引力系统**：
  - 薪资越高，吸引力越大
  - 技能要求越低，应聘者越多
  - 每个岗位每天可能产生0-3位应聘者

### 3. 面试系统

#### 玩家面试
- 玩家查看候选人的完整技能信息
- 可以添加面试备注
- 直接决定录用或拒绝
- 评分范围：70-100分（录用）或30-70分（拒绝）

#### 人事面试
- 系统自动评估候选人
- 评分标准：
  - 技能匹配度（40分）：专属技能等级评分
  - 工作经验（30分）：经验年限评分
  - 薪资合理性（20分）：期望薪资与岗位薪资的匹配度
  - 随机因素（10分）：模拟面试表现
- 60分及格，自动标记通过/拒绝
- 自动生成面试备注

### 4. 应聘者状态管理

应聘者状态流转：
```
PENDING（待处理）
  ↓
REVIEWING（审核中）/ INTERVIEWING（面试中）
  ↓
ACCEPTED（已通过）/ REJECTED（已拒绝）
  ↓
HIRED（已雇佣）
```

### 5. 岗位状态管理

岗位状态：
- **ACTIVE**（活跃中）：正在招聘，会生成新应聘者
- **PAUSED**（已暂停）：暂停招聘，不生成新应聘者
- **CLOSED**（已关闭）：关闭招聘
- **FILLED**（已满员）：招聘已满

## 新增文件

### 数据模型
- `app/src/main/java/com/example/yjcy/data/JobPosting.kt`
  - `JobPosting`：岗位发布数据类
  - `JobApplicant`：应聘者数据类
  - `JobPostingStatus`：岗位状态枚举
  - `ApplicantStatus`：应聘者状态枚举
  - `InterviewType`：面试类型枚举
  - `InterviewResult`：面试结果数据类

### 服务层
- `app/src/main/java/com/example/yjcy/service/JobPostingService.kt`
  - 岗位发布管理
  - 应聘者生成逻辑
  - 面试流程处理
  - 雇佣操作

### UI组件
- `app/src/main/java/com/example/yjcy/ui/components/JobPostingDialog.kt`
  - 岗位发布表单
  - 实时岗位预览

- `app/src/main/java/com/example/yjcy/ui/components/ApplicantManagementDialog.kt`
  - 应聘者列表展示
  - 统计信息显示
  - 面试和雇佣操作

- `app/src/main/java/com/example/yjcy/ui/components/InterviewDialog.kt`
  - 面试类型选择（玩家/人事）
  - 玩家面试界面
  - 面试结果展示

- `app/src/main/java/com/example/yjcy/ui/components/NewTalentMarketDialog.kt`
  - 重构后的人才市场主界面
  - 岗位列表管理
  - 统计信息展示

## 使用方法

### 替换旧的TalentMarketDialog

在 `EmployeeManagementContent.kt` 或其他调用位置：

```kotlin
// 旧版本
if (showTalentMarket) {
    TalentMarketDialog(
        saveData = saveData,
        onDismiss = { showTalentMarket = false },
        onRecruitCandidate = { candidate ->
            // 雇佣逻辑
        }
    )
}

// 新版本
if (showTalentMarket) {
    NewTalentMarketDialog(
        saveData = saveData,
        onDismiss = { showTalentMarket = false },
        onRecruitCandidate = { candidate ->
            // 雇佣逻辑
        }
    )
}
```

### 集成时间系统

在游戏主循环或时间推进逻辑中添加：

```kotlin
// 每天推进时调用
val jobPostingService = JobPostingService.getInstance()
jobPostingService.generateApplicantsForActiveJobs(daysElapsed = 1)
```

## 核心算法

### 岗位吸引力计算

```kotlin
吸引力 = (薪资评分 + 技能评分) / 2

薪资评分 = 
  - 平均薪资 >= 20000: 1.0
  - 平均薪资 >= 15000: 0.8
  - 平均薪资 >= 10000: 0.6
  - 平均薪资 >= 5000:  0.4
  - 其他:              0.2

技能评分 = (6 - 最低技能要求) / 5
```

### 应聘者数量计算

```kotlin
基础概率 = 吸引力 × 经过天数

应聘者数量 = 
  if (随机数 < 基础概率)
    随机生成 1-3 人
  else
    0 人
```

### 人事面试评分

```kotlin
总分 = 技能匹配度分数 + 经验分数 + 薪资合理性分数 + 随机分数

技能匹配度分数 = (专属技能等级 / 5) × 40
经验分数 = (min(经验年限, 30) / 30) × 30
薪资合理性分数 = (1 - |期望薪资 - 岗位平均薪资| / 岗位平均薪资) × 20
随机分数 = 0-10分

通过标准 = 总分 >= 60分
```

## 特性优势

1. **更真实的招聘体验**：模拟真实的岗位发布和应聘流程
2. **策略性更强**：玩家需要权衡薪资、技能要求和招聘效率
3. **时间维度**：引入时间推进机制，增加游戏深度
4. **灵活的面试方式**：玩家可选择亲自面试或委托人事部门
5. **完整的状态管理**：清晰的应聘者和岗位状态流转

## 扩展建议

### 短期扩展
1. **岗位有效期**：设置岗位的自动关闭时间
2. **应聘者质量等级**：根据市场状况调整候选人质量
3. **招聘成本**：增加发布岗位的费用

### 中期扩展
1. **多轮面试**：支持初试、复试等多轮面试流程
2. **面试官系统**：不同员工作为面试官，影响面试结果
3. **候选人推荐**：员工可以推荐候选人

### 长期扩展
1. **猎头服务**：付费获取高质量候选人
2. **校园招聘**：特殊的招聘渠道
3. **竞争对手挖人**：AI公司也会发布岗位，与玩家竞争人才

## 注意事项

1. **数据持久化**：JobPostingService 使用内存存储，需要集成到存档系统
2. **性能优化**：大量应聘者时，考虑分页加载
3. **平衡性调整**：根据游戏测试调整吸引力系统和评分算法
4. **UI响应**：确保岗位列表和应聘者列表的实时更新

## 测试建议

1. **基础流程测试**
   - 创建岗位 → 等待应聘者 → 面试 → 雇佣

2. **边界情况测试**
   - 无资金发布岗位
   - 员工数量达到上限
   - 关闭有应聘者的岗位
   - 同时发布多个岗位

3. **性能测试**
   - 大量岗位和应聘者的渲染性能
   - 频繁刷新的响应速度

## 总结

岗位发布系统成功实现了从"被动浏览"到"主动招聘"的转变，为游戏增加了更多的策略深度和真实感。系统设计清晰，扩展性强，可以根据游戏需求进一步优化和扩展。

