# TapTapåˆè§„è®¤è¯æ¥å…¥ä¿®æ­£è¯´æ˜

## ä¿®æ­£åŸå› 

æ ¹æ® [TapTapå®˜æ–¹æ–‡æ¡£](https://developer.taptap.cn/docs/sdk/anti-addiction/guide/)ï¼Œåˆè§„è®¤è¯çš„æ­£ç¡®æ¥å…¥æ–¹å¼æ˜¯ï¼š

**åœ¨TapTapç™»å½•æˆåŠŸåè‡ªåŠ¨è§¦å‘åˆè§„è®¤è¯**ï¼Œè€Œä¸æ˜¯ä½œä¸ºç‹¬ç«‹çš„ä¸»èœå•å…¥å£ã€‚

## ä¿®æ”¹å†…å®¹

### 1. TapLoginScreen.kt - ç™»å½•ç•Œé¢è‡ªåŠ¨è§¦å‘åˆè§„è®¤è¯

**æ·»åŠ çš„åŠŸèƒ½**ï¼š
- æ·»åŠ  `ComplianceState` çŠ¶æ€ç±»ï¼ŒåŒ…å«ï¼š
  - `Idle`: ç­‰å¾…åˆè§„è®¤è¯
  - `Checking`: æ­£åœ¨è¿›è¡Œåˆè§„è®¤è¯
  - `Success`: åˆè§„è®¤è¯æˆåŠŸ
  - `Error`: è®¤è¯å¤±è´¥
  - `PeriodRestrict`: æ—¶æ®µé™åˆ¶
  - `DurationLimit`: æ—¶é•¿é™åˆ¶
  - `AgeLimit`: å¹´é¾„é™åˆ¶

- ä¿®æ”¹ `login()` æ–¹æ³•ï¼Œåœ¨ç™»å½•æˆåŠŸåè‡ªåŠ¨è°ƒç”¨ï¼š
  ```kotlin
  startCompliance(activity, result.account.unionId)
  ```

- æ·»åŠ åˆè§„è®¤è¯çŠ¶æ€æ˜¾ç¤ºå¡ç‰‡ï¼Œå®æ—¶æ˜¾ç¤ºè®¤è¯è¿›åº¦å’Œç»“æœ

**UIå±•ç¤º**ï¼š
ç™»å½•æˆåŠŸåä¼šæ˜¾ç¤ºåˆè§„è®¤è¯çŠ¶æ€å¡ç‰‡ï¼ŒåŒ…å«ï¼š
- çŠ¶æ€å›¾æ ‡ï¼ˆâ³ â° âœ… âŒ ç­‰ï¼‰
- çŠ¶æ€æè¿°
- åŠ è½½åŠ¨ç”»ï¼ˆè®¤è¯ä¸­æ—¶ï¼‰
- æ ¹æ®çŠ¶æ€çš„èƒŒæ™¯é¢œè‰²

### 2. YjcyApplication.kt - æ³¨å†Œå…¨å±€åˆè§„è®¤è¯å›è°ƒ

**æ·»åŠ çš„åŠŸèƒ½**ï¼š
- æ–°å¢ `registerComplianceCallback()` æ–¹æ³•
- æ³¨å†Œå…¨å±€å›è°ƒå¤„ç†æ‰€æœ‰åˆè§„è®¤è¯äº‹ä»¶
- åœ¨ `onCreate()` ä¸­è°ƒç”¨å›è°ƒæ³¨å†Œ

**å¤„ç†çš„å›è°ƒäº‹ä»¶**ï¼š
- `LOGIN_SUCCESS`: è®¤è¯æˆåŠŸï¼Œç©å®¶å¯ä»¥æ­£å¸¸æ¸¸æˆ
- `EXITED`: ç”¨æˆ·é€€å‡ºè®¤è¯ï¼Œéœ€è¦é€€å‡ºæ¸¸æˆæˆ–è¿”å›ç™»å½•ç•Œé¢
- `SWITCH_ACCOUNT`: ç”¨æˆ·è¦æ±‚åˆ‡æ¢è´¦å·
- `PERIOD_RESTRICT`: æ—¶æ®µé™åˆ¶ï¼ˆæœªæˆå¹´äºº22:00-æ¬¡æ—¥8:00ï¼‰
- `DURATION_LIMIT`: æ—¶é•¿é™åˆ¶ï¼ˆæœªæˆå¹´äººæ¸¸æˆæ—¶é•¿è¾¾åˆ°é™åˆ¶ï¼‰
- `AGE_LIMIT`: å¹´é¾„é™åˆ¶ï¼ˆç©å®¶å¹´é¾„ä¸æ»¡è¶³æ¸¸æˆé€‚é¾„é™åˆ¶ï¼‰
- `INVALID_CLIENT_OR_NETWORK_ERROR`: å®¢æˆ·ç«¯é…ç½®é”™è¯¯æˆ–ç½‘ç»œé—®é¢˜
- `REAL_NAME_STOP`: å®åè®¤è¯æµç¨‹è¢«åœæ­¢

### 3. MainActivity.kt - ç§»é™¤ç‹¬ç«‹çš„åˆè§„è®¤è¯å…¥å£

**åˆ é™¤çš„å†…å®¹**ï¼š
- åˆ é™¤ `TapComplianceScreen` å¯¼å…¥
- åˆ é™¤ `taptap_compliance` è·¯ç”±
- åˆ é™¤ä¸»èœå•çš„"ğŸ›¡ï¸ åˆè§„è®¤è¯"æŒ‰é’®

### 4. TapComplianceScreen.kt - å¯ä»¥åˆ é™¤

è¿™ä¸ªæ–‡ä»¶ä¸å†éœ€è¦ï¼Œå¯ä»¥æ‰‹åŠ¨åˆ é™¤ï¼š
```
d:\AI\Yjcy\app\src\main\java\com\example\yjcy\taptap\TapComplianceScreen.kt
```

è¯¥æ–‡ä»¶å·²ç»æ²¡æœ‰ä»»ä½•åœ°æ–¹å¼•ç”¨ã€‚

## ä½¿ç”¨æµç¨‹

### æ­£ç¡®çš„ä½¿ç”¨æµç¨‹ï¼š

1. ç”¨æˆ·ç‚¹å‡»ä¸»èœå•çš„"ğŸ® TapTapç™»å½•"
2. è¿›å…¥TapLoginScreenï¼Œç‚¹å‡»"ä½¿ç”¨ TapTap ç™»å½•"
3. ç™»å½•æˆåŠŸåï¼š
   - æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯å¡ç‰‡
   - **è‡ªåŠ¨è§¦å‘åˆè§„è®¤è¯**ï¼ˆç”±SDKå¼¹å‡ºè®¤è¯çª—å£ï¼‰
   - æ˜¾ç¤ºåˆè§„è®¤è¯çŠ¶æ€å¡ç‰‡
4. ç”¨æˆ·å®Œæˆå®åè®¤è¯å’Œé˜²æ²‰è¿·è®¤è¯
5. è®¤è¯æˆåŠŸåï¼ŒçŠ¶æ€å¡ç‰‡æ˜¾ç¤º"âœ… åˆè§„è®¤è¯æˆåŠŸ"
6. ç©å®¶å¯ä»¥æ­£å¸¸æ¸¸æˆ

### è®¤è¯çª—å£ç¤ºä¾‹ï¼ˆå›¾2ï¼‰ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    æ¸¸æˆå¥åº·æé†’             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ‚¨å½“å‰ä¸ºæœªæˆå¹´è´¦å·ï¼Œå·²è¢«   â”‚
â”‚ çº³å…¥é˜²æ²‰è¿·ç³»ç»Ÿ...          â”‚
â”‚                            â”‚
â”‚ æ ¹æ®ç›¸å…³æ³•è§„è§„å®šï¼Œå½“å‰æ—¶   â”‚
â”‚ æ®µä¸å¾—è¿›å…¥æ¸¸æˆ...          â”‚
â”‚                            â”‚
â”‚        [åˆ‡æ¢è´¦å·]           â”‚
â”‚                            â”‚
â”‚        [é€€å‡ºæ¸¸æˆ]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¿™ä¸ªçª—å£ç”±TapTap SDKè‡ªåŠ¨æ˜¾ç¤ºå’Œç®¡ç†ï¼Œä¸éœ€è¦è‡ªå·±å®ç°UIã€‚

## æŠ€æœ¯ç»†èŠ‚

### åˆè§„è®¤è¯è§¦å‘æ—¶æœºï¼š
```kotlin
// TapLoginScreen.kt
when (val result = TapLoginManager.loginWithBasicProfile(activity)) {
    is TapLoginManager.LoginResult.Success -> {
        loginState = LoginState.LoggedIn(result.account)
        
        // ç™»å½•æˆåŠŸåï¼Œè‡ªåŠ¨è§¦å‘åˆè§„è®¤è¯
        startCompliance(activity, result.account.unionId)
    }
}
```

### åˆè§„è®¤è¯å›è°ƒå¤„ç†ï¼š
```kotlin
// YjcyApplication.kt
TapComplianceManager.registerCallback(object : TapComplianceManager.ComplianceCallback {
    override fun onLoginSuccess(extra: Map<String, Any>?) {
        Log.i(TAG, "âœ… åˆè§„è®¤è¯æˆåŠŸ")
        // è®¤è¯æˆåŠŸï¼Œç©å®¶å¯ä»¥æ­£å¸¸æ¸¸æˆ
    }
    
    override fun onPeriodRestrict(extra: Map<String, Any>?) {
        Log.w(TAG, "â° æ—¶æ®µé™åˆ¶ï¼šå½“å‰æ—¶æ®µä¸å…è®¸æ¸¸æˆ")
        // æœªæˆå¹´äººåœ¨é™åˆ¶æ—¶æ®µå†…
    }
    
    // ... å…¶ä»–å›è°ƒå¤„ç†
})
```

## é‡è¦æ³¨æ„äº‹é¡¹

1. **å¿…é¡»å…ˆç™»å½•TapTap**ï¼šåˆè§„è®¤è¯ä¾èµ–TapTapç™»å½•çš„unionId
2. **è‡ªåŠ¨å¼¹çª—**ï¼šè®¤è¯çª—å£ç”±SDKè‡ªåŠ¨æ˜¾ç¤ºï¼Œä¸éœ€è¦æ‰‹åŠ¨å®ç°UI
3. **å…¨å±€å›è°ƒ**ï¼šåœ¨Applicationä¸­æ³¨å†Œçš„å›è°ƒä¼šå¤„ç†æ‰€æœ‰è®¤è¯äº‹ä»¶
4. **çŠ¶æ€æ˜¾ç¤º**ï¼šTapLoginScreenä¼šå®æ—¶æ˜¾ç¤ºå½“å‰çš„è®¤è¯çŠ¶æ€
5. **å¼€å‘è€…ä¸­å¿ƒé…ç½®**ï¼šé€‚é¾„é™åˆ¶ç­‰åŠŸèƒ½éœ€è¦åœ¨TapTapå¼€å‘è€…ä¸­å¿ƒåå°é…ç½®

## æµ‹è¯•å»ºè®®

1. ä½¿ç”¨æµ‹è¯•è´¦å·ï¼ˆæœªæˆå¹´è´¦å·ï¼‰æµ‹è¯•é˜²æ²‰è¿·åŠŸèƒ½
2. éªŒè¯ç™»å½•åè‡ªåŠ¨å¼¹å‡ºåˆè§„è®¤è¯çª—å£
3. æµ‹è¯•æ—¶æ®µé™åˆ¶ï¼ˆ22:00-8:00ï¼‰
4. æµ‹è¯•æ—¶é•¿é™åˆ¶
5. éªŒè¯çŠ¶æ€å¡ç‰‡çš„å®æ—¶æ›´æ–°

## å‚è€ƒæ–‡æ¡£

- [TapTapå®åè®¤è¯å’Œé˜²æ²‰è¿·å¼€å‘æŒ‡å—](https://developer.taptap.cn/docs/sdk/anti-addiction/guide/)
- [TapTapç™»å½•å¼€å‘æŒ‡å—](https://developer.taptap.cn/docs/sdk/taptap-login/guide/)
