# 电竞赛事系统完整实现方案

## 问题分析

当前赛事系统存在以下严重问题：

### 1. 城市杯赛程太短
- 当前只有7天，体验感不足
- 应该延长到至少14-21天

### 2. 玩家无法参与
- ❌ 无法安排自己的战队出战
- ❌ 看不到有哪些战队参赛
- ❌ 看不到赛程表
- ❌ 没有BP（Ban/Pick）环节
- ❌ 没有任何决策点

### 3. 缺少核心玩法
- 没有战队报名系统
- 没有赛程查看界面
- 没有比赛观战界面
- 没有BP决策
- 没有战术选择

## 完整实现方案

### 阶段一：赛事报名系统

#### 1.1 报名界面
```
┌─────────────────────────────────────┐
│  🏆 城市杯 - 报名阶段                │
├─────────────────────────────────────┤
│  报名截止：还剩 3 天                 │
│  报名费：¥50,000                     │
│  奖金池：¥500,000                    │
│                                      │
│  已报名战队：8/16                    │
│  ├─ 我的战队 ✓                      │
│  ├─ 龙之战队                         │
│  ├─ 凤凰俱乐部                       │
│  └─ ...                              │
│                                      │
│  [报名参赛] [查看规则]               │
└─────────────────────────────────────┘
```

#### 1.2 战队选择
- 玩家必须先组建战队（5名主力选手）
- 可选2名替补
- 检查战队实力是否达标

### 阶段二：赛程系统

#### 2.1 赛程表界面
```
┌─────────────────────────────────────┐
│  📅 城市杯赛程表                     │
├─────────────────────────────────────┤
│  小组赛 A组 (第1-7天)                │
│  ├─ Day 1: 我的战队 vs 龙之战队      │
│  ├─ Day 2: 凤凰俱乐部 vs 幻影电竞    │
│  ├─ Day 3: 我的战队 vs 凤凰俱乐部    │
│  └─ ...                              │
│                                      │
│  小组赛 B组 (第1-7天)                │
│  └─ ...                              │
│                                      │
│  淘汰赛 (第8-12天)                   │
│  ├─ Day 8: 1/4决赛 #1                │
│  ├─ Day 9: 1/4决赛 #2                │
│  └─ ...                              │
│                                      │
│  决赛 (第13-14天)                    │
│  └─ Day 14: 总决赛                   │
└─────────────────────────────────────┘
```

#### 2.2 赛程特点
- **城市杯**：14天（小组赛7天 + 淘汰赛5天 + 决赛2天）
- **全国锦标赛**：21天
- **全球总决赛**：30天

### 阶段三：BP系统

#### 3.1 BP界面（比赛前）
```
┌─────────────────────────────────────┐
│  ⚔️ BP阶段 - 我的战队 vs 龙之战队    │
├─────────────────────────────────────┤
│  Ban位 (各3个)                       │
│  我方：[选择英雄] [选择英雄] [选择英雄]│
│  对方：？？？ ？？？ ？？？           │
│                                      │
│  Pick位 (各5个)                      │
│  上单：[选择英雄]                    │
│  打野：[选择英雄]                    │
│  中单：[选择英雄]                    │
│  ADC：[选择英雄]                     │
│  辅助：[选择英雄]                    │
│                                      │
│  [确认阵容]                          │
└─────────────────────────────────────┘
```

#### 3.2 BP规则
- 每方Ban 3个英雄
- 每方Pick 5个英雄（对应5个位置）
- 不能选择被Ban的英雄
- 不能重复选择
- 选手只能选择自己英雄池中的英雄

### 阶段四：比赛观战系统

#### 4.1 比赛进行界面
```
┌─────────────────────────────────────┐
│  🎮 比赛进行中                       │
├─────────────────────────────────────┤
│  我的战队  vs  龙之战队              │
│     0            0                   │
│                                      │
│  比赛时间：15:32                     │
│                                      │
│  实时战况：                          │
│  ├─ 10:00 - 我方打野击杀对方中单     │
│  ├─ 12:30 - 对方ADC击杀我方辅助      │
│  ├─ 15:00 - 我方团战获胜！           │
│  └─ ...                              │
│                                      │
│  [暂停观战] [快进]                   │
└─────────────────────────────────────┘
```

#### 4.2 比赛结果
```
┌─────────────────────────────────────┐
│  🏆 比赛结束                         │
├─────────────────────────────────────┤
│  我的战队  2 : 1  龙之战队           │
│                                      │
│  MVP：张三 (我方中单)                │
│  ├─ KDA: 8/2/12                      │
│  ├─ 伤害：45,230                     │
│  └─ 参团率：85%                      │
│                                      │
│  选手表现：                          │
│  ├─ 上单 李四：7.5分                 │
│  ├─ 打野 王五：8.2分                 │
│  ├─ 中单 张三：9.1分 ⭐              │
│  ├─ ADC 赵六：7.8分                  │
│  └─ 辅助 钱七：7.2分                 │
│                                      │
│  [继续]                              │
└─────────────────────────────────────┘
```

### 阶段五：战术决策系统

#### 5.1 赛前准备
- **战术选择**：进攻型/防守型/平衡型
- **重点培养**：选择本场重点保护的位置
- **针对性训练**：针对对手弱点制定策略

#### 5.2 比赛中决策
- **暂停调整**：每场比赛2次暂停机会
- **换人**：可以换上替补选手
- **战术调整**：改变战术风格

### 阶段六：积分榜系统

#### 6.1 小组积分榜
```
┌─────────────────────────────────────┐
│  📊 A组积分榜                        │
├─────────────────────────────────────┤
│  排名  战队名      胜  负  积分      │
│  1    我的战队     5   1   15       │
│  2    龙之战队     4   2   12       │
│  3    凤凰俱乐部   3   3    9       │
│  4    幻影电竞     0   6    0       │
│                                      │
│  出线规则：前2名晋级淘汰赛           │
└─────────────────────────────────────┘
```

## 数据结构设计

### 1. 赛事数据
```kotlin
data class Tournament(
    val id: String,
    val tier: TournamentTier,  // 城市杯/锦标赛/世界赛
    val year: Int,
    val season: TournamentSeason?,
    val status: TournamentStatus,  // 报名/进行中/已完成
    val currentPhase: TournamentPhase,  // 报名/小组赛/淘汰赛/决赛
    val registeredTeams: MutableList<Team>,
    val schedule: MutableList<ScheduledMatch>,
    val results: MutableMap<String, MatchResult>,
    val prizePool: Long,
    val playerTeamId: String?  // 玩家战队ID（如果参赛）
)
```

### 2. 比赛数据
```kotlin
data class ScheduledMatch(
    val id: String,
    val date: Date,
    val blueTeam: Team,
    val redTeam: Team,
    val format: MatchFormat,  // BO1/BO3/BO5
    val phase: String,  // 小组赛/1/4决赛等
    val status: MatchStatus,  // 未开始/进行中/已完成
    val result: MatchResult?,
    val bpData: BPData?  // BP数据
)

data class BPData(
    val blueBans: List<Hero>,
    val redBans: List<Hero>,
    val bluePicks: Map<HeroPosition, Hero>,
    val redPicks: Map<HeroPosition, Hero>
)
```

### 3. 比赛结果
```kotlin
data class MatchResult(
    val winner: Team,
    val loser: Team,
    val score: String,  // "2:1"
    val mvp: EsportsPlayer,
    val playerStats: Map<String, PlayerMatchStats>
)

data class PlayerMatchStats(
    val kills: Int,
    val deaths: Int,
    val assists: Int,
    val damage: Long,
    val rating: Double  // 评分
)
```

## UI实现清单

### 必须实现的界面

1. ✅ **赛事列表界面** (已有)
2. ❌ **赛事详情界面** (新增)
   - 显示赛事信息
   - 显示参赛战队
   - 报名按钮

3. ❌ **赛程表界面** (新增)
   - 显示所有比赛
   - 按阶段分组
   - 高亮玩家战队的比赛

4. ❌ **BP界面** (新增)
   - Ban/Pick选择
   - 英雄池筛选
   - 阵容预览

5. ❌ **比赛观战界面** (新增)
   - 实时战况
   - 比分显示
   - 快进/暂停

6. ❌ **比赛结果界面** (新增)
   - 比分
   - MVP
   - 选手数据

7. ❌ **积分榜界面** (新增)
   - 小组积分
   - 出线情况

## 实现优先级

### P0 (必须立即实现)
1. 延长城市杯赛程到14天
2. 赛事报名系统
3. 赛程表显示
4. 参赛战队列表

### P1 (核心玩法)
5. BP系统
6. 比赛观战
7. 积分榜

### P2 (增强体验)
8. 战术决策
9. 选手数据统计
10. 赛事回放

## 下一步行动

1. 修改 `TournamentType.REGIONAL` 的 duration 从 7 改为 14
2. 创建赛事报名界面
3. 创建赛程表界面
4. 实现BP系统
5. 实现比赛模拟逻辑
6. 创建比赛观战界面

## 预计工作量

- 数据结构调整：2小时
- 报名系统：3小时
- 赛程系统：4小时
- BP系统：6小时
- 比赛模拟：8小时
- UI界面：10小时

**总计：约33小时**

## 用户体验流程

```
1. 玩家看到赛事通知
   ↓
2. 进入赛事中心，看到"城市杯报名中"
   ↓
3. 点击报名，选择自己的战队
   ↓
4. 支付报名费，报名成功
   ↓
5. 查看赛程表，看到自己的比赛安排
   ↓
6. 比赛日到来，收到通知
   ↓
7. 进入BP界面，Ban/Pick英雄
   ↓
8. 观看比赛进行，看到实时战况
   ↓
9. 比赛结束，查看结果和数据
   ↓
10. 查看积分榜，确认出线情况
   ↓
11. 继续下一场比赛...
   ↓
12. 最终获得名次和奖励
```

这才是一个完整的电竞赛事体验！
