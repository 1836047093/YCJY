# 网络游戏注册数加成系统说明

## 功能概述

网络游戏的总注册数现在受到**游戏评分**和**粉丝数量**两个因素的影响，高评分游戏和高粉丝量公司可以获得更多的玩家注册。

## 一、游戏评分加成

### 加成规则

根据游戏评分的不同，注册数会获得不同的加成：

| 评分范围 | 加成效果 | 说明 |
|---------|---------|------|
| ≤ 5.0 | 无加成 | 低分游戏不会获得注册数加成 |
| 5.0 ~ 8.0 | +30% | 中等评分游戏获得小幅度提升 |
| ≥ 8.0 | +80% | 高分游戏获得极大幅度提升 |

## 二、粉丝数量加成

### 加成规则（分段递减设计）

粉丝数量对注册数的影响采用**分段递减**机制，确保数值平衡：

| 粉丝数量 | 加成计算 | 最大加成 | 说明 |
|---------|---------|---------|------|
| 0 ~ 10K | 每1K粉丝 +2% | +20% | 前期效果明显 |
| 10K ~ 50K | 每1K粉丝 +1% | 前期20% + 额外40% = 60% | 中期递减 |
| 50K ~ 100K | 每1K粉丝 +0.5% | 前期60% + 额外25% = 85% | 后期缓慢增长 |
| 100K+ | 封顶 | 85% | 避免数值爆炸 |

### 粉丝加成示例

- **5K粉丝**：5 × 2% = +10% 注册数
- **25K粉丝**：20% + (15 × 1%) = +35% 注册数
- **75K粉丝**：60% + (25 × 0.5%) = +72.5% 注册数
- **150K粉丝**：封顶在 +85% 注册数

## 影响范围

**评分加成**和**粉丝加成**会同时影响网络游戏的以下注册数计算：

1. **首日注册数**：游戏首次发售时的初始注册人数
2. **每日新增注册数**：游戏上线后每天新增的注册玩家数

注意：两种加成**可以叠加**，但分别计算。

## 综合计算示例

### 示例1：高分游戏 + 高粉丝（评分 8.5，粉丝 25K）

1. 基础首日注册：1500 人
2. 应用评分加成：1500 × 1.8 = 2700 人
3. 应用粉丝加成：2700 × 1.35 = **3645 人**
4. **总加成：+143%**

### 示例2：中等评分 + 中等粉丝（评分 6.5，粉丝 5K）

1. 基础首日注册：1500 人
2. 应用评分加成：1500 × 1.3 = 1950 人
3. 应用粉丝加成：1950 × 1.10 = **2145 人**
4. **总加成：+43%**

### 示例3：高分游戏 + 低粉丝（评分 8.5，粉丝 500）

1. 基础首日注册：1500 人
2. 应用评分加成：1500 × 1.8 = 2700 人
3. 应用粉丝加成：2700 × 1.0 = **2700 人**（粉丝不足1K，无加成）
4. **总加成：+80%**（仅评分加成）

### 示例4：低分游戏 + 高粉丝（评分 4.8，粉丝 25K）

1. 基础首日注册：1500 人
2. 应用评分加成：1500 × 1.0 = 1500 人（无加成）
3. 应用粉丝加成：1500 × 1.35 = **2025 人**
4. **总加成：+35%**（仅粉丝加成）

## 实现细节

### 修改的文件

1. **GameRevenueData.kt**
   - 新增 `applyRatingBonus()` 函数：根据评分计算注册数加成
   - 新增 `applyFansBonus()` 函数：根据粉丝数量计算注册数加成（分段递减）
   - 修改 `addDailyRevenueForGame()` 函数：添加 `gameRating` 和 `fanCount` 参数
   - 在首日注册和每日新增注册计算中应用评分加成和粉丝加成

2. **MainActivity.kt**
   - 在调用 `addDailyRevenueForGame()` 时传入游戏评分和粉丝数
   - 从 `releasedGame.gameRating?.finalScore` 获取评分
   - 传入当前公司的 `fans` 数量

### 关键代码

```kotlin
// 评分加成计算函数
private fun applyRatingBonus(baseRegistrations: Int, gameRating: Float?): Int {
    if (gameRating == null) return baseRegistrations
    
    return when {
        gameRating >= 8.0f -> {
            // 评分 >= 8：极大幅度提升（+80%）
            (baseRegistrations * 1.8).toInt()
        }
        gameRating > 5.0f -> {
            // 评分 5-8：小幅度提升（+30%）
            (baseRegistrations * 1.3).toInt()
        }
        else -> baseRegistrations // 评分 <= 5：无加成
    }
}

// 粉丝加成计算函数（分段递减）
private fun applyFansBonus(baseRegistrations: Int, fanCount: Int): Int {
    if (fanCount <= 0) return baseRegistrations
    
    // 计算粉丝加成百分比（分段递减）
    val bonusPercent = when {
        fanCount <= 10000 -> {
            // 0-10K 粉丝：每1K粉丝 +2%（最多 +20%）
            (fanCount / 1000) * 2.0
        }
        fanCount <= 50000 -> {
            // 10K-50K 粉丝：前10K给20%，后续每1K粉丝 +1%（最多额外 +40%）
            val base = 20.0
            val extra = ((fanCount - 10000) / 1000) * 1.0
            base + extra
        }
        fanCount <= 100000 -> {
            // 50K-100K 粉丝：前50K给60%，后续每1K粉丝 +0.5%（最多额外 +25%）
            val base = 60.0
            val extra = ((fanCount - 50000) / 1000) * 0.5
            base + extra
        }
        else -> {
            // 100K+ 粉丝：封顶在 +85%
            85.0
        }
    }
    
    val multiplier = 1.0 + (bonusPercent / 100.0)
    return (baseRegistrations * multiplier).toInt()
}
```

## 使用效果

### 游戏品质导向
- **高质量游戏奖励**：评分8分及以上的游戏能获得显著更多的玩家注册
- **品质导向**：鼓励玩家制作高质量游戏，提升团队技能水平
- **真实体验**：模拟真实市场中高评分游戏更受欢迎的现象

### 粉丝积累价值
- **宣传的意义**：通过宣传活动积累粉丝，可以提升所有网络游戏的注册数
- **长期收益**：粉丝是公司的长期资产，投入宣传费用可以带来持续回报
- **递减设计**：前期粉丝效果明显，后期递减，避免数值失衡
- **策略性**：玩家需要在"宣传获取粉丝"和"直接投入开发"之间做权衡

### 平衡性设计
- **可叠加但有上限**：评分和粉丝加成可叠加，但都有合理的上限
- **低分游戏仍可运营**：即使评分低，通过积累粉丝仍能获得一定收益
- **数值封顶**：粉丝加成封顶在85%，避免后期数值爆炸

## 注意事项

1. 评分加成和粉丝加成仅对**网络游戏**生效，单机游戏不受影响
2. 两种加成会同时影响**首日注册**和**每日新增注册**
3. 如果游戏未评分（`gameRating == null`），则不应用评分加成
4. 粉丝数不足1000时，粉丝加成为0
5. 评分加成、粉丝加成与**宣传指数**、**玩家兴趣值**等其他因素共同作用
6. 粉丝数量是**公司级**的，会影响该公司所有网络游戏的注册数

## 数值平衡分析

### 最佳组合效果
- **评分10分 + 粉丝100K**：基础 × 1.8 × 1.85 = 基础 × **3.33**（+233%）
- **评分8分 + 粉丝50K**：基础 × 1.8 × 1.6 = 基础 × **2.88**（+188%）
- **评分6分 + 粉丝25K**：基础 × 1.3 × 1.35 = 基础 × **1.755**（+75.5%）

### 与宣传指数的叠加
根据记忆系统，宣传指数100%时可提升50%首发销量/注册数。三者叠加效果：
- 基础注册数 × 评分加成 × 粉丝加成 × 宣传指数加成
- 理论最大：基础 × 1.8 × 1.85 × 1.5 ≈ 基础 × **5.0**（+400%）

这个数值在游戏平衡性上是合理的，因为需要：
- 高技能团队（评分10分需要很多高级员工）
- 大量宣传投入（粉丝100K需要花费数百万）
- 完整宣传流程（宣传指数100%需要多次宣传）
