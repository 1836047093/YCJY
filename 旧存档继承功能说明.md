# 旧存档继承功能说明

## 功能概述

从版本 **2.0.8** 开始，游戏新增了**旧存档继承功能**。当玩家加载旧版本的存档时，可以选择继承旧存档中的员工和游戏，开启全新的游戏体验。

## 核心特性

### 🎯 自动检测旧存档
- 系统会自动检测存档版本
- 当存档版本低于当前游戏版本时，自动弹出继承对话框
- 版本比较基于语义化版本号（如 2.0.3 < 2.0.8）

### 👥 员工全量继承
- **所有员工**都会被继承到新存档
- 员工保留原有的所有属性：
  - 姓名、职位、技能等级
  - 薪资、满意度、工作状态
  - 专长和个人属性

### 🎮 游戏选择继承
- 玩家可以从旧存档的**已发售游戏**中选择继承
- **最多选择 3 款游戏**
- 继承的游戏特点：
  - 保留游戏名称、主题、平台等基础信息
  - 保留游戏评分和玩法设计
  - **保持已完成状态**，开发进度100%
  - **可以直接发售**，无需重新开发

### 🔄 游戏进度重置
- 时间重置：回到第 1 年 1 月 1 日
- 资金重置：300 万初始资金
- 粉丝重置：从 0 开始
- 竞争对手重置：重新生成10家新的竞争对手
- 游戏状态：
  - **保持开发进度100%**（已完成）
  - 发售状态重置为"准备发售"（可直接点击发售按钮）
  - 清空员工分配
  - 清空服务器、收益等运营数据

## 使用流程

### 1️⃣ 加载旧存档
在"继续游戏"界面选择一个旧版本的存档卡片

### 2️⃣ 继承对话框
系统自动弹出继承对话框，显示：
- 旧存档版本信息
- 可继承的员工数量
- 所有已发售游戏列表

### 3️⃣ 选择游戏
- 从列表中勾选要继承的游戏（0-3款）
- 每款游戏显示名称、主题、类型、评分
- 已选择游戏会高亮显示
- 实时显示选择进度（如 2/3）

### 4️⃣ 确认操作
两个操作选项：

#### **取消**
- 关闭对话框，返回存档列表
- 不进行任何操作

#### **开始继承**
- 创建继承后的新存档
- 包含所有员工和选中的游戏
- 游戏进度重置，开始新的挑战

## UI 界面

### 对话框样式
- 🎮 游戏手柄图标 + "旧存档继承" 标题
- 橙色提示：显示旧版本号和当前版本号
- 绿色员工卡片：显示可继承的员工数量
- 游戏列表：可滚动，支持多选（最多3个）
- 两个操作按钮：取消（灰）、开始继承（绿）

### 游戏卡片
- ✅ 选中状态：蓝色高亮背景 + 勾选框
- ⚪ 未选中状态：灰色背景
- 显示信息：
  - 游戏名称（加粗白色）
  - 主题 | 类型 | 评分

## 设计理念

### 🎯 兼顾新老玩家
- **新手友好**：可以继承高级员工，跳过艰难的成长期
- **老玩家**：可以带着精英团队开启新挑战
- **灵活选择**：可以只继承员工，不继承游戏

### 🔄 重置机制合理
- **保留核心资产**：员工和游戏是最重要的资产
- **重置游戏进度**：防止数值膨胀，保持游戏平衡
- **游戏可直接发售**：继承的游戏已完成开发，玩家可以立即发售获得收益

### 📈 游戏策略深度
- 选择哪些游戏继承？高评分？还是个人喜欢的？
- 继承的游戏可以直接发售，立即获得收益（评分越高销量越好）
- 可以利用高评分游戏快速积累粉丝和资金

## 技术实现

### 版本比较函数
```kotlin
fun isOlderVersion(saveVersion: String, currentVersion: String): Boolean
```
- 支持语义化版本号（如 2.0.3, 2.1.0）
- 逐位比较版本号数字
- 解析失败时视为相同版本

### 继承数据创建
```kotlin
fun createInheritedSaveData(legacySaveData: SaveData, selectedGames: List<Game>): SaveData
```
- 保留：公司名、LOGO、创始人、职业、所有员工
- 继承：选中的游戏（重置状态）
- 重置：时间、资金、粉丝、竞争对手、服务器、收益、客诉等
- 更新：存档版本号为当前版本

### UI 组件
```kotlin
@Composable
fun LegacySaveInheritDialog(...)
```
- Material 3 风格对话框
- 响应式布局，适配不同屏幕
- LazyColumn 支持大量游戏列表
- 多选逻辑（最多3个）

## 使用场景

### 场景一：老玩家升级体验
> 玩家A在旧版本中培养了一支 5 级满级团队，但游戏内容已经玩腻了。升级到新版本后，可以继承精英团队，用更快的速度体验新版本的新内容。

### 场景二：跳过艰难成长期
> 玩家B觉得游戏前期招聘和培养员工太慢，可以从旧存档继承高级员工，直接进入中后期玩法。

### 场景三：经典游戏重制
> 玩家C在旧版本中做了一款 9.5 分的经典游戏，可以选择继承这款游戏，在新版本中重新开发和发售，看看能否再创辉煌。

### 场景四：纯净新开局
> 玩家D不想继承任何游戏，只继承员工团队，从零开始制作全新的游戏阵容。

## 注意事项

### ✅ 可以继承
- 所有员工（技能、薪资、满意度等）
- 已发售的游戏（名称、主题、平台、评分等）

### ❌ 不会继承
- 游戏时间和日期
- 资金和粉丝数
- 竞争对手和新闻
- 服务器和收益数据
- 招聘岗位和客诉
- 成就和教程进度
- GVA 获奖记录

### ⚠️ 特别说明
1. 继承的游戏需要重新开发和发售
2. 游戏会从设计阶段开始，保留原有评分
3. 高技能员工开发速度更快，可以快速完成
4. 继承后的存档版本号会更新为当前版本
5. 如果不想继承游戏，可以选择0款游戏（只继承员工）

## 向后兼容

- ✅ 旧版本存档必须选择继承才能进入游戏
- ✅ 同版本或新版本存档直接加载，不弹出继承对话框
- ✅ 继承功能完全可选（可以选择0款游戏）
- ✅ 完全不影响现有游戏流程

## 版本信息

- **功能版本**：2.0.8+
- **实现文件**：MainActivity.kt
- **核心函数**：
  - `ContinueScreen()` - 继续游戏界面
  - `LegacySaveInheritDialog()` - 继承对话框
  - `isOlderVersion()` - 版本比较
  - `createInheritedSaveData()` - 数据创建

---

**提示**：旧版本存档必须通过继承功能才能进入游戏，但可以灵活选择继承0-3款游戏，完全按你的想法开始新挑战！
