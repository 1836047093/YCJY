# 宣传指数时间衰减机制说明

## 功能概述
为游戏宣传系统添加了时间衰减机制，宣传指数会随着时间自然降低，鼓励玩家在合适的时机进行宣传投入。

## 衰减规则

### 衰减触发时机
- **每月结算时**（每月1日）自动进行衰减计算
- 与粉丝增长、竞争对手更新等月结算事件同步执行

### 衰减速度设计

| 游戏状态 | 每月衰减率 | 设计理念 |
|---------|-----------|---------|
| **开发中游戏** | 4% | 较慢衰减，鼓励提前宣传积累热度 |
| **准备发售** | 4% | 保持热度，等待发售时机 |
| **价格设置中** | 4% | 即将发售，热度维持 |
| **已发售游戏** | 10% | 快速衰减，发售后热度自然下降 |
| **已评分游戏** | 10% | 同已发售，热度持续下降 |
| **已下架游戏** | 0% | 不再衰减 |

### 衰减底线
- **最低值**：0%（不会出现负值）
- **最高值**：100%（宣传时自动限制）

## 数值平衡

### 开发中游戏（4%/月）
```
100% → 96% → 92% → 88% → 84% → 80% → ...
```
- **半衰期**：约12.5个月降至50%
- **完全消退**：约25个月降至0%
- **有效期**：发售前3-6个月宣传最有效

### 已发售游戏（10%/月）
```
100% → 90% → 80% → 70% → 60% → 50% → ...
```
- **半衰期**：约5个月降至50%
- **完全消退**：约10个月降至0%
- **效果**：发售后热度快速下降，符合市场规律

## 设计理念

### 1. 时机策略
- **太早宣传**：宣传指数会在发售前大幅衰减，浪费资金
- **太晚宣传**：来不及积累足够的宣传热度
- **最佳时机**：发售前2-4个月开始集中宣传

### 2. 资源分配
- 鼓励玩家合理规划宣传预算
- 避免盲目宣传导致资源浪费
- 需要在开发进度和宣传时机之间平衡

### 3. 长期运营
- 已发售游戏的宣传效果快速衰减
- 持续宣传成本高，需要考虑ROI
- 新游戏宣传更有价值

## 游戏体验影响

### 对玩家的影响
1. **增加策略深度**：需要考虑宣传时机
2. **提高决策重要性**：宣传投入需要规划
3. **更真实的市场模拟**：热度自然衰减符合现实

### 对游戏平衡的影响
1. **防止过度宣传**：100%上限 + 时间衰减
2. **鼓励新项目**：老游戏热度自然下降
3. **资金管理考验**：需要在宣传和开发间平衡

## 实现细节

### 代码位置
**MainActivity.kt** - 月结算部分（第1290-1322行）

### 核心逻辑
```kotlin
// 月结算：宣传指数衰减
games = games.map { game ->
    if (game.promotionIndex > 0f) {
        // 根据游戏状态确定衰减速度
        val decayRate = when (game.releaseStatus) {
            GameReleaseStatus.DEVELOPMENT,
            GameReleaseStatus.READY_FOR_RELEASE,
            GameReleaseStatus.PRICE_SETTING -> 0.04f  // 开发中：4%/月
            GameReleaseStatus.RELEASED,
            GameReleaseStatus.RATED -> 0.10f  // 已发售：10%/月
            else -> 0f  // 已下架：不衰减
        }
        
        val newPromotionIndex = (game.promotionIndex - decayRate).coerceAtLeast(0f)
        game.copy(promotionIndex = newPromotionIndex)
    } else {
        game
    }
}
```

### 日志输出
- 自动记录每次衰减的详细信息
- 格式：`宣传指数衰减: 游戏名 (状态) 原值% -> 新值% (衰减X%)`
- 便于调试和数值调整

## 玩家建议

### 最佳实践
1. **开发初期**：先专注开发，暂不宣传
2. **开发中期**（50-70%进度）：开始适度宣传
3. **开发后期**（80-100%进度）：集中宣传，冲击100%热度
4. **发售时刻**：宣传指数影响首发销量和注册数（100%时提升50%）
5. **发售后**：宣传性价比降低，考虑转向新项目

### 常见误区
- ❌ 过早宣传（游戏开发进度<30%时大量投入）
- ❌ 忽视衰减（长期不关注宣传指数变化）
- ❌ 过度宣传已发售游戏（性价比低）
- ✅ 阶段性宣传（根据开发进度分批投入）
- ✅ 集中宣传（发售前2-4个月重点投入）
- ✅ 及时发售（达到高热度后尽快发售）

## 数值调整建议

如需调整平衡，可以修改以下参数：

| 参数 | 当前值 | 调整方向 | 影响 |
|-----|--------|---------|-----|
| **开发中衰减率** | 4% | 增大→加快衰减<br>减小→减慢衰减 | 影响宣传有效期 |
| **已发售衰减率** | 10% | 增大→热度下降更快<br>减小→热度维持更久 | 影响发售后运营策略 |

## 版本历史
- **V1.0**（2025-01-20）：初始实现
  - 开发中游戏：4%/月衰减
  - 已发售游戏：10%/月衰减
  - 集成到月结算系统
