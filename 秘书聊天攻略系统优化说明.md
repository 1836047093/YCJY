# 秘书聊天攻略系统优化说明

## 概述
大幅优化秘书聊天功能，从简单的寒暄对话升级为**智能游戏攻略助手**，能够识别玩家问题并提供详细的游戏指引和攻略。

## 优化内容

### 1. 新增游戏攻略系统（8大类）

#### 📖 新手引导类
**关键词**：怎么玩、如何玩、玩法、怎么开始、新手、教程、不会玩、开局、初期、前期、起步

**提供内容**：
- 完整的新手四步攻略（招聘→开发→发售→赚钱）
- 开局资金管理建议
- 最优招聘策略（6个Lv.1员工配置）
- 第一款游戏选择建议（单机休闲游戏）
- 快速上手指南

**示例回复**：
```
📖 新手攻略指南：

【第一步：招聘员工】
前往"👥员工管理"页面招聘员工。建议先招2-3个Lv.1-2的员工，薪资设为最低标准的115%...

【第二步：开发游戏】
在"🎮项目管理"创建新游戏。游戏开发分三阶段...
```

---

#### ⭐ 员工系统类
**关键词**：员工等级、等级、技能等级、等级作用、升级、招聘、招人、应聘者、怎么招、培养、培训、解雇、裁员

**提供内容**：
- **员工等级详解**：
  - 等级范围（Lv.1-5）
  - 开发速度倍率（0.5x - 1.6x）
  - 游戏评分影响（5-6分 vs 8-9分）
  - 薪资标准（1万 - 5万）
  
- **招聘系统攻略**：
  - 最低薪资标准（等级×1万）
  - 应聘者数量梯度（100%、115%、125%、150%）
  - 不同策略建议（前期省钱、中期平衡、后期扩张）
  
- **培养与解雇建议**

**示例回复**：
```
⭐ 员工等级系统详解：

【等级作用】
1️⃣ 开发速度：等级越高，开发进度越快
   - Lv.1 = 0.5倍速 | Lv.5 = 1.6倍速

2️⃣ 游戏评分：高级员工做的游戏评分更高
   - 全员Lv.5可达8-9分

3️⃣ 薪资标准：等级越高薪资越高
```

---

#### 🎮 游戏开发类
**关键词**：游戏开发、开发游戏、三阶段、阶段、分配员工、开发速度、开发慢、太慢了、游戏评分、评分低、分数、质量

**提供内容**：
- **三阶段开发系统**：
  - 阶段1：📋需求文档（策划师）
  - 阶段2：🎨美术音效（美工/音乐家）
  - 阶段3：💻程序实现（程序员）
  - 重要提醒：阶段完成自动清空员工
  
- **提升开发速度方法**：
  - 增加人数（每人+30%效率）
  - 提升等级（Lv.5是Lv.1的3倍快）
  - 最佳配置建议
  
- **游戏评分系统**：
  - 7个影响因素详解
  - 评分提升建议
  - 新手正常评分范围

---

#### 💰 财务管理类
**关键词**：破产、负债、没钱了、钱不够、亏损、赚钱、收益、盈利、怎么赚、资金、财务、收支

**提供内容**：
- **破产预防指南**：
  - 破产条件（负债50万）
  - 常见破产原因（4条）
  - 预防措施（5条）
  - 紧急补救方法
  
- **赚钱攻略**：
  - 单机游戏收益模式
  - 网络游戏收益模式
  - 快速赚钱策略（4条）
  - 开局建议
  
- **财务管理建议**

**示例回复**：
```
💰 破产预防指南：

【破产条件】负债达到50万 → 游戏结束！

【常见破产原因】
1. 员工太多，工资开支过大
2. 买了太贵的服务器
3. 游戏开发周期太长

【预防措施】
✅ 前期只招6-8个员工
✅ 网游先买最便宜的服务器（10万）
✅ 定期查看"🏢公司概览"的收支情况
```

---

#### 🖥️ 服务器管理类
**关键词**：服务器、买服务器、哪里买、服务器在哪、网游上线、上线失败、网络游戏、服务器容量、不够用

**提供内容**：
- **服务器购买指南**：
  - 购买位置（底部"🖥️服务器"）
  - 4种服务器类型（星尘系列D/C/B/A）
  - 详细购买流程
  - 新手建议（先买10万的D型）
  
- **网游上线要求**：
  - 必须先购买服务器
  - 单机游戏不需要服务器
  
- **容量扩展方案**

**示例回复**：
```
🖥️ 服务器管理指南：

【购买位置】
在底部导航栏点击"🖥️服务器"进入服务器管理页面

【服务器类型】（星尘系列）
💫 星尘-D型：10万容量，¥10万（推荐新手）
⭐ 星尘-C型：50万容量，¥50万

【重要】网络游戏上线前必须先买服务器！
```

---

#### 📢 宣传营销类
**关键词**：宣传、营销、推广、广告、粉丝、粉丝数、增加粉丝

**提供内容**：
- **宣传系统详解**：
  - 宣传效果（提升25%）
  - 3种宣传规模（5万/15万/50万）
  - 使用方法和按钮位置
  - 策略建议（累积到100%）
  - 投入时机建议
  
- **粉丝系统**：
  - 粉丝作用
  - 增加粉丝方法

**示例回复**：
```
📢 游戏宣传系统：

【宣传效果】
提升首发销量（单机）或首发注册数（网游）
宣传指数100%时提升25%！

【宣传选项】
💰 小规模（5万）→ +20%指数
💵 中等规模（15万）→ +40%指数
💸 大规模（50万）→ +80%指数
```

---

#### 🗺️ 功能位置类
**关键词**：在哪、哪里、找不到、位置、入口

**提供内容**：
- **底部5个导航功能**：
  - 🏢 公司概览
  - 👥 员工管理
  - 🎮 项目管理
  - 🖥️ 服务器
  - ⚙️ 设置
  
- **常用功能快速定位**：
  - 招聘员工路径
  - 开发游戏路径
  - 买服务器路径
  - 查看收支路径
  - 宣传游戏路径

**示例回复**：
```
🗺️ 功能导航地图：

【底部导航栏】（5个主要功能）
🏢 公司概览 - 查看资金、市值、粉丝等
👥 员工管理 - 招聘、管理、解雇员工
🎮 项目管理 - 创建、开发、发售游戏

【常用功能快速定位】
- 招聘员工：👥员工管理 → 岗位发布
- 买服务器：🖥️服务器 → 选择网游 → 购买
```

---

### 2. 优化回复优先级

**新的匹配优先级**（从高到低）：
1. **敏感词过滤**（最高优先级）
2. **空消息处理**
3. **回答性陈述句**（"吃了"、"累了"等对秘书反问的回答）
4. **游戏攻略内容**（核心优先级！即使是疑问句也优先匹配）✨
   - 新手引导
   - 员工系统
   - 游戏开发
   - 财务管理
   - 服务器管理
   - 宣传营销
   - 功能位置
5. **日常疑问句**（包含"吗"、"没"、"呢"等疑问词的非攻略问题）
6. **日常对话**
   - 问候
   - 询问状态
   - 感谢
   - 赞美
   - 工作相关
   - 关心
   - 情感
7. **特殊标点符号**
8. **兜底回复**

**优化理由**：
- ✅ **攻略优先**：确保玩家询问游戏相关问题时，即使用疑问句，也能获得详细攻略而非通用回复
- ✅ **避免误判**：防止"员工等级有什么用？"被识别为普通疑问句而返回"建议查看相关数据"
- ✅ **智能识别**：只要消息包含攻略关键词（如"员工"、"等级"、"破产"、"服务器"等），就优先提供攻略

**关键改进**（v2.1）：
将游戏攻略匹配提前到疑问句判断之前，确保即使是"员工等级有什么用？"这样的疑问句，也能匹配到员工系统攻略，而不是返回通用的"建议查看相关数据"。

---

### 3. 关键词覆盖

每个攻略类别都设计了丰富的关键词，确保玩家用各种表达方式都能触发：

**示例**：
- 破产相关：破产、负债、没钱了、钱不够、亏损
- 服务器相关：服务器、买服务器、哪里买、服务器在哪、网游上线
- 新手引导：怎么玩、如何玩、玩法、怎么开始、新手、教程、不会玩
- 员工等级相关：员工等级、等级、技能等级、等级作用、升级、员工作用、员工有什么用、等级有什么用、技能有什么用、员工的作用
- 招聘相关：招聘、招人、应聘者、怎么招、招不到人、薪资、工资、薪水、招聘系统

---

## 技术实现

### 修改文件
- **ChatMessage.kt**：秘书回复管理器

### 新增代码结构
```kotlin
// 游戏攻略系统（8大类）
private val tutorialPatterns = mapOf(...)      // 新手引导
private val employeePatterns = mapOf(...)      // 员工系统
private val developmentPatterns = mapOf(...)   // 游戏开发
private val financePatterns = mapOf(...)       // 财务管理
private val serverPatterns = mapOf(...)        // 服务器管理
private val promotionPatterns = mapOf(...)     // 宣传营销
private val locationPatterns = mapOf(...)      // 功能位置

// 优化后的回复生成逻辑
fun generateReply(playerMessage: String): String {
    // 1. 敏感词过滤
    // 2. 空消息处理
    // 3. 回答性陈述句
    // 4. 疑问句匹配
    // 5. 游戏攻略匹配（新增！）
    // 6. 日常对话匹配
    // 7. 特殊标点符号
    // 8. 兜底回复
}
```

---

## 使用示例

### 示例1：新手玩家
**玩家**："怎么玩啊，我不会玩"

**秘书**：
```
📖 新手攻略指南：

【第一步：招聘员工】
前往"👥员工管理"页面招聘员工...

【第二步：开发游戏】
在"🎮项目管理"创建新游戏...

【第三步：游戏发售】
开发完成后点击"发售游戏"...

【第四步：赚取收益】
单机游戏靠销量赚钱，网游靠付费内容...

老板加油！💪
```

---

### 示例2：不了解员工等级
**玩家**："员工等级有什么用"

**秘书**：
```
⭐ 员工等级系统详解：

【等级范围】Lv.1 - Lv.5

【等级作用】
1️⃣ 开发速度：等级越高，开发进度越快
   - Lv.1 = 0.5倍速 | Lv.2 = 0.8倍
   - Lv.3 = 1.0倍速 | Lv.4 = 1.3倍
   - Lv.5 = 1.6倍速（最快！）

2️⃣ 游戏评分：高级员工做的游戏评分更高
   - 全员Lv.5可达8-9分（高分游戏！）
   - 全员Lv.1只有5-6分（一般游戏）

3️⃣ 薪资标准：等级越高薪资越高
   - Lv.1最低1万 | Lv.5最低5万

【建议】前期用Lv.1-2，后期培养Lv.4-5精英团队！
```

---

### 示例3：担心破产
**玩家**："我要破产了怎么办"

**秘书**：
```
💰 破产预防指南：

【破产条件】负债达到50万 → 游戏结束！

【常见破产原因】
1. 员工太多，工资开支过大
2. 买了太贵的服务器
3. 游戏开发周期太长，收入跟不上
4. 没有控制成本

【预防措施】
✅ 前期只招6-8个员工
✅ 网游先买最便宜的服务器（10万）
✅ 做单机游戏不需要服务器
✅ 控制开发周期在2-3个月
✅ 定期查看"🏢公司概览"的收支情况

【紧急措施】
如果快破产了：
- 立即裁员减少开支
- 关闭部分服务器
- 快速发售游戏获得收入
- 读取之前的存档重来

记住：开源节流，量入为出！💪
```

---

### 示例4：找不到功能
**玩家**："在哪里买服务器啊"

**秘书**：
```
🖥️ 服务器管理指南：

【购买位置】
在底部导航栏点击"🖥️服务器"进入服务器管理页面

【服务器类型】（星尘系列）
💫 星尘-D型：10万容量，¥10万（推荐新手）
⭐ 星尘-C型：50万容量，¥50万
🌟 星尘-B型：200万容量，¥200万
✨ 星尘-A型：500万容量，¥500万

【使用流程】
1. 点击底部"🖥️服务器"
2. 选择要管理的网游
3. 点击"购买新服务器"
4. 选择服务器类型并购买

【重要】网络游戏上线前必须先买服务器！单机游戏不需要服务器。

【建议】前期买最便宜的D型（10万）就够了，后期玩家多了再升级！
```

---

## 优化效果

### ✅ 解决的问题
1. **新手困惑**：玩家不知道怎么开始游戏 → 提供详细新手指南
2. **等级作用不明**：不了解员工等级系统 → 详细解释三大作用
3. **容易破产**：不清楚破产机制 → 提供预防和补救措施
4. **找不到功能**：不知道功能入口在哪 → 提供详细导航地图
5. **服务器困惑**：不知道哪里买服务器 → 详细购买流程
6. **开发疑惑**：不懂三阶段开发 → 完整的开发系统讲解

### 📈 提升的体验
1. **智能化**：秘书从简单聊天升级为游戏攻略助手
2. **实用性**：提供可操作的具体步骤和建议
3. **全面性**：覆盖游戏的8个核心系统
4. **友好性**：emoji + 结构化排版，易读易懂
5. **层次性**：每个问题都有简版和详版回复，满足不同需求

---

## 向后兼容

- 保留所有原有的寒暄对话功能
- 敏感词过滤系统完整保留
- 不影响现有的聊天体验
- 新增的攻略系统作为补充，不覆盖原有功能

---

## 后续优化方向

1. **动态数据**：读取玩家当前游戏数据，提供个性化建议
2. **上下文记忆**：记住玩家之前的问题，提供连贯对话
3. **快捷按钮**：常见问题按钮，一键获取攻略
4. **图文攻略**：添加图示说明，更直观
5. **进阶攻略**：中后期玩法、高级策略等

---

## 更新历史

### v2.1 (2025-01-25 23:36)
**修复问题**：
- 🐛 修复了"员工等级有什么用？"返回通用回复的问题
- ✨ 将游戏攻略匹配提前到疑问句判断之前
- 📝 扩展员工系统关键词（增加"员工作用"、"员工有什么用"、"等级有什么用"等）
- 📝 扩展招聘系统关键词（增加"薪资"、"工资"、"薪水"等）

**优化效果**：
- 现在玩家问"员工等级有什么用？"会返回详细的等级系统解释
- 任何包含攻略关键词的疑问句都能正确触发对应攻略
- 避免了通用回复"建议查看相关数据"的误判

### v2.0 (2025-01-25)
**初始版本**：
- 新增8大游戏攻略系统
- 智能识别玩家问题并提供详细指引
- 覆盖新手引导、员工、开发、财务等核心系统
