# 💰 资金流水查询指南

## 功能说明

游戏现在内置了**资金流水追踪系统**，会自动记录所有资金变动（收入和支出），并提供详细的流水汇总报告。

## 如何查看资金流水

### 方法1：查看实时日志（推荐）

在 Android Studio 的 Logcat 中查看，筛选标签：`💰资金流水`

每笔资金变动都会实时输出日志，格式如下：
```
💰资金流水: 💸 员工工资: -¥150000 | 余额:¥2850000 | 5名员工
💰资金流水: 🏦 贷款到账: +¥2500000 | 余额:¥5350000 | 短期贷款 | 9个月 | 月还¥284768
💰资金流水: 🏦 贷款还款: -¥284768 | 余额:¥5065232 | 1笔贷款
```

### 方法2：查看资金流水汇总报告

在游戏中打开秘书聊天，输入以下命令之一：
- `资金流水`
- `资金报告`
- `查看流水`
- `钱去哪了`
- `资金去向`

系统会自动输出详细的资金流水汇总报告。

## 报告示例

```
========== 资金流水报告 ==========
📅 统计期间: 全部记录（最近50条）

💰 期初余额: ¥30,000,000
💰 期末余额: ¥2,100,000

📈 总收入: +¥8,500,000
  📈 游戏收入: +¥6,000,000
  🏦 贷款到账: +¥2,500,000

📉 总支出: -¥36,400,000
  💸 员工工资: -¥4,500,000
  🖥️ 服务器费用: -¥25,000,000
  🏦 贷款还款: -¥2,850,000
  📢 游戏宣传: -¥1,500,000
  📚 员工培训: -¥800,000
  🔄 游戏更新: -¥1,000,000
  🛒 购买服务器: -¥500,000
  其他支出: -¥250,000

💹 净变化: -¥27,900,000
==================================
```

## 资金变动类型

### 📈 收入类型
- **游戏收入**：单机游戏销售、网游付费内容
- **贷款到账**：申请银行贷款
- **子公司分红**：子公司上缴利润
- **GM作弊**：使用GM工具箱增加资金

### 📉 支出类型
- **员工工资**：每月员工工资支出
- **服务器费用**：网游服务器月租费
- **贷款还款**：每月还贷本息
- **员工培训**：培训员工技能
- **游戏宣传**：宣传游戏提升知名度
- **游戏更新**：更新游戏内容
- **购买服务器**：购买新服务器
- **招聘费用**：发布招聘岗位
- **游戏开发**：游戏开发成本
- **子公司注资**：向子公司注入资金
- **收购IP**：收购游戏IP
- **其他支出**：杂项支出

## 使用场景

### 场景1：资金骤降排查

**问题**：资金从30M降到2M，不知道钱去哪了

**操作步骤**：
1. 在秘书聊天中输入 `资金流水`
2. 查看汇总报告中的**总支出**部分
3. 重点关注金额最大的支出项

**常见原因**：
- 服务器费用过高（网游玩家多需要大量服务器）
- 员工工资过高（人员过多或工资过高）
- 贷款还款压力大（多笔贷款同时还款）
- 频繁宣传和更新游戏

### 场景2：月度收支分析

定期查看资金流水报告，分析每月收支情况：
- 收入是否稳定增长
- 哪项支出占比最大
- 是否需要削减成本
- 是否需要追加贷款

### 场景3：投资决策

在做重大投资决策前（如收购IP、大规模招聘），查看当前资金流水：
- 当前收支平衡状态
- 每月固定支出金额
- 是否有足够的现金流支撑投资

## 技巧建议

### 💡 成本控制建议

如果发现资金流出过快，可以采取以下措施：

1. **优化服务器**：
   - 关闭不盈利的网游服务器
   - 使用公共池服务器共享成本
   - 选择性价比高的服务器类型

2. **控制人力成本**：
   - 解雇低效员工
   - 暂停不必要的招聘
   - 控制涨薪频率

3. **减少投资**：
   - 暂停游戏更新和宣传
   - 延缓新项目开发
   - 不进行大额投资

4. **增加收入**：
   - 发售更多游戏
   - 提高游戏质量和评分
   - 开发高收益的网游

### 💡 查询技巧

- **定期查看**：建议每月查看一次资金流水
- **对比分析**：前后对比不同月份的流水报告
- **重点关注**：关注占比最大的支出项
- **提前规划**：根据流水报告规划下月预算

## 系统特性

### ✅ 优点
- **全自动记录**：无需手动操作，自动追踪所有资金变动
- **详细分类**：按类型分类，一目了然
- **实时更新**：每笔交易实时记录
- **汇总报告**：提供收支汇总和净变化
- **历史记录**：保留最近1000条流水记录

### ⚠️ 注意事项
- 流水记录会占用一定内存（约1000条）
- 如果需要更长历史记录，建议定期截图保存报告
- 重启游戏后历史流水会清空（正在开发持久化功能）

## 常见问题

**Q：为什么查不到某笔交易？**
A：可能该交易发生在流水系统启用之前。系统只记录启用后的交易。

**Q：如何清空流水记录？**
A：流水记录在游戏重启后自动清空。如需手动清空，请重启游戏。

**Q：流水记录会保存到存档吗？**
A：目前流水记录是临时的，不会保存到存档。正在开发存档功能。

**Q：如何导出流水报告？**
A：建议使用 Android Studio 的 Logcat 导出功能，或者截图保存。

## 开发计划

未来版本将添加：
- ✨ 流水记录持久化（保存到存档）
- ✨ 图表可视化（收支趋势图）
- ✨ 自定义时间段查询
- ✨ 导出Excel报表
- ✨ 预算管理和超支警告
