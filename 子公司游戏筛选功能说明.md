# 子公司游戏筛选功能说明

## 功能概述
在项目管理的下拉选项中新增"子公司游戏"筛选选项，用于显示从竞争对手公司收购来的游戏。

## 修改内容

### 1. **ProjectDisplayType 枚举更新** (`EnhancedProjectManagement.kt`)
添加新的项目显示类型：
```kotlin
enum class ProjectDisplayType(val displayName: String) {
    DEVELOPING("正在开发"),
    UPDATING("正在更新"),
    RELEASED("已发售"),
    REMOVED("已下架"),
    SUBSIDIARY("子公司游戏")  // 新增
}
```

### 2. **游戏筛选逻辑** (`EnhancedProjectManagement.kt`)
添加子公司游戏的筛选条件：
```kotlin
ProjectDisplayType.SUBSIDIARY -> games.filter { game ->
    // 从竞争对手公司收购来的游戏（id以inherited_开头）
    game.id.startsWith("inherited_")
}
```

**筛选规则**：
- 所有 ID 以 `"inherited_"` 开头的游戏都会被识别为子公司游戏
- 这是在收购竞争对手公司时自动生成的标识（见 MainActivity.kt 第1910行）

### 3. **空状态提示文本** (`EnhancedProjectManagement.kt`)
添加对应的空状态提示：
- **标题**：`"暂无子公司游戏"`
- **说明**：`"收购竞争对手公司后，其旗下的游戏将在此显示"`

## 使用流程

1. **收购竞争对手公司**：
   - 在"🎯竞争对手"标签页中选择一家公司
   - 点击"💰 收购"按钮
   - 完成竞价并成功收购

2. **继承游戏**：
   - 收购成功后，被收购公司旗下的游戏会自动转为玩家的游戏
   - 这些游戏的 ID 会被标记为 `inherited_xxxxx`
   - 游戏状态自动设置为"已发售"

3. **查看子公司游戏**：
   - 进入"📋 项目"标签页
   - 点击顶部下拉菜单
   - 选择"子公司游戏"
   - 查看所有从收购中继承的游戏

4. **管理子公司游戏**：
   - 可以为子公司游戏开始更新
   - 可以查看游戏的收益数据
   - 可以下架游戏
   - 可以为游戏分配员工进行更新开发

## 游戏状态说明

### 收购时的游戏转换
当成功收购竞争对手公司时（`MainActivity.kt` 第1908-1927行）：
```kotlin
val inheritedPlayerGames = inheritedGames.map { competitorGame ->
    Game(
        id = "inherited_${System.currentTimeMillis()}_${Random.nextInt()}",
        name = competitorGame.name,
        theme = competitorGame.theme,
        platforms = competitorGame.platforms,
        businessModel = competitorGame.businessModel,
        assignedEmployees = emptyList(),
        releaseStatus = GameReleaseStatus.RELEASED,  // 已发售状态
        developmentProgress = 100f,
        isCompleted = true,
        currentPhase = DevelopmentPhase.PROGRAMMING,
        phaseProgress = 100f,
        rating = competitorGame.rating,
        releasePrice = 50f,  // 默认价格
        promotionIndex = 0f,
        version = 1.0f,
        monetizationItems = emptyList()
    )
}
```

### 子公司游戏的特点
- ✅ **ID 标识**：以 `"inherited_"` 开头
- ✅ **发售状态**：自动设置为 `RELEASED`
- ✅ **开发完成度**：100%
- ✅ **继承属性**：保留原游戏的名称、主题、平台、评分等
- ✅ **初始配置**：默认价格 50 元，版本 1.0，无付费内容

## 显示位置

子公司游戏会同时出现在以下筛选选项中：
1. **✅ 已发售** - 所有已发售的游戏（包括子公司游戏）
2. **✅ 子公司游戏** - 仅显示收购来的游戏
3. **✅ 正在更新** - 如果为子公司游戏开始更新，也会显示在此

## 向后兼容性
- ✅ 旧存档完全兼容，现有游戏不受影响
- ✅ 没有收购记录时，"子公司游戏"选项为空
- ✅ 新增的枚举值不会破坏现有逻辑

## 注意事项

1. **游戏数量统计**：
   - 子公司游戏会计入总游戏数量
   - 会参与排行榜和市值计算

2. **收益系统**：
   - 继承的网游会自动初始化收益数据
   - 玩家可以立即开始管理这些游戏的运营

3. **更新和维护**：
   - 子公司游戏可以像普通游戏一样进行更新
   - 可以为游戏分配员工
   - 可以修改付费内容（网游）

4. **下架操作**：
   - 可以将子公司游戏下架
   - 下架后会移动到"已下架"筛选选项

## 未来可能的优化

1. **重新发售功能**：
   - 可以考虑添加"重新发售"选项
   - 让玩家为子公司游戏设定新价格
   - 进行新一轮的宣传和推广

2. **子公司标识**：
   - 在游戏卡片上显示"子公司"标签
   - 区分自研游戏和收购游戏

3. **收购历史**：
   - 记录游戏的原归属公司
   - 显示收购日期和价格

4. **整合策略**：
   - 添加整合成本概念
   - 子公司游戏初期可能需要额外投入

---

**修改文件**：
- `d:\AI\Yjcy\app\src\main\java\com\example\yjcy\ui\EnhancedProjectManagement.kt`

**相关文件**：
- `d:\AI\Yjcy\app\src\main\java\com\example\yjcy\MainActivity.kt` (第1897-1949行：收购成功回调)
- `d:\AI\Yjcy\app\src\main\java\com\example\yjcy\ui\CompetitorScreen.kt` (收购功能实现)
