# 网络游戏付费内容功能实现说明

## 功能概述
为网络游戏添加付费内容选择功能，玩家在开发网络游戏时可以选择不同的付费方式，并设置价格（也可以稍后设置）。

## 已创建的文件

### 1. MonetizationData.kt
**位置**: `app/src/main/java/com/example/yjcy/data/MonetizationData.kt`

包含：
- `MonetizationItemType` 枚举：所有付费内容类型
  - 皮肤与外观、成长加速道具、稀有装备、赛季通行证、强力角色
  - VIP会员、抽卡系统、扩展包、资源包等
- `MonetizationItem` 数据类：单个付费内容项
- `MonetizationConfig` 对象：根据游戏主题推荐付费内容

### 2. MonetizationSelectionStep.kt
**位置**: `app/src/main/java/com/example/yjcy/ui/MonetizationSelectionStep.kt`

UI组件：
- `MonetizationSelectionStep`：付费内容选择步骤
- `MonetizationItemCard`：单个付费内容卡片（可开关、设置价格）

### 3. Game数据类更新
已在 `GameData.kt` 中为 `Game` 数据类添加字段：
```kotlin
val monetizationItems: List<MonetizationItem> = emptyList()
```

## 集成步骤

### 方法1：修改 SuperEnhancedGameDevelopmentDialog（推荐）

在 `EnhancedProjectManagement.kt` 的 `SuperEnhancedGameDevelopmentDialog` 函数中：

1. **添加状态变量**（第456行后）：
```kotlin
var monetizationItems by remember { mutableStateOf<List<com.example.yjcy.data.MonetizationItem>>(emptyList()) }

// 计算总步骤数
val totalSteps = if (selectedBusinessModel == BusinessModel.ONLINE_GAME) 5 else 4
val isLastStep = currentStep == totalSteps - 1
```

2. **修改步骤指示器**（第478行）：
```kotlin
repeat(totalSteps) { index ->  // 改为 totalSteps
```

3. **添加付费内容选择步骤**（第520行后）：
```kotlin
3 -> {
    // 如果是网络游戏，显示付费内容选择
    if (selectedBusinessModel == BusinessModel.ONLINE_GAME) {
        MonetizationSelectionStep(
            selectedTheme = selectedTheme,
            monetizationItems = monetizationItems,
            onMonetizationItemsChange = { monetizationItems = it }
        )
    } else {
        // 单机游戏直接显示确认页
        GameConfirmationStep(
            gameName = gameName,
            theme = selectedTheme,
            platforms = selectedPlatforms.toList(),
            businessModel = selectedBusinessModel
        )
    }
}
4 -> {
    // 网络游戏的确认步骤
    GameConfirmationStep(
        gameName = gameName,
        theme = selectedTheme,
        platforms = selectedPlatforms.toList(),
        businessModel = selectedBusinessModel
    )
}
```

4. **修改游戏创建逻辑**（第564-580行）：
```kotlin
onClick = {
    if (isLastStep) {
        // 创建游戏
        if (gameName.isNotBlank() && selectedTheme != null && 
            selectedPlatforms.isNotEmpty() && selectedBusinessModel != null) {
            val newGame = Game(
                id = java.util.UUID.randomUUID().toString(),
                name = gameName,
                theme = selectedTheme!!,
                platforms = selectedPlatforms.toList(),
                businessModel = selectedBusinessModel!!,
                developmentProgress = 0f,
                isCompleted = false,
                revenue = 0L,
                assignedEmployees = emptyList(),
                monetizationItems = monetizationItems  // 添加这一行
            )
            onGameCreated(newGame)
        }
    } else {
        currentStep++
    }
}
```

5. **更新按钮文本**（第592-600行）：
```kotlin
Text(
    text = if (isLastStep) "创建游戏" else "下一步",
    color = if (when (currentStep) {
        0 -> gameName.isNotBlank()
        1 -> selectedTheme != null
        2 -> selectedPlatforms.isNotEmpty() && selectedBusinessModel != null
        else -> true  // 付费内容可选
    }) Color(0xFF10B981) else Color.White.copy(alpha = 0.5f)
)
```

## 使用流程

1. 玩家开发新游戏
2. 输入游戏名称
3. 选择游戏主题（如：动作）
4. 选择平台和商业模式
5. **【新增】如果选择"网络游戏"，显示付费内容选择步骤**
   - 根据游戏主题推荐相应的付费内容
   - 可以开关每个付费项
   - 可以设置价格或稍后设置
6. 确认并创建游戏

## 效果展示

### 动作游戏的付费内容选项：
- ✅ 皮肤与外观（角色皮肤、武器外观等）
- ✅ 成长加速道具（经验加成、金币加成等）
- ✅ 稀有装备（特殊武器、强力装备等）
- ✅ 赛季通行证（赛季奖励、专属内容）
- ✅ 强力角色（可购买的角色或英雄）

每个选项都可以：
1. 通过开关启用/禁用
2. 点击设置价格
3. 不设置价格，稍后在游戏上线后设置

## 注意事项

- 付费内容仅对**网络游戏**可用
- 单机游戏跳过付费内容选择步骤
- 价格可以为空（null），表示稍后设置
- 不同游戏主题推荐不同的付费内容类型
